(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,a){e.exports=a(699)},221:function(e,t){},223:function(e,t){},259:function(e,t){},260:function(e,t){},319:function(e,t,a){},695:function(e,t){},698:function(e,t,a){},699:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(63),c=a.n(s),i=a(18),o=a(48),u=a(181),l="auth_user",p="unauth_user",m=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case l:return{isAuthenticated:!0,user:e.payload};case p:return{isAuthenticated:!1,user:e.payload};default:return{isAuthenticated:null!==localStorage.getItem("token"),user:null}}},d=a(28),h=a(31),v=a(22),b=a(23),f=a(25),g=a(24),k=a(26),y=function(e){function t(){return Object(v.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"checkAuth",value:function(){return this.props.isAuthenticated?r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(d.b,{activeClassName:"active",className:"nav-item nav-link",to:"/"},"Home ",r.a.createElement("span",{className:"sr-only"},"(current)")),r.a.createElement(d.b,{to:"/logout",className:"nav-item nav-link"},"Logout")):r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(d.b,{activeClassName:"active",className:"nav-item nav-link",to:"/"},"Home ",r.a.createElement("span",{className:"sr-only"},"(current)")),r.a.createElement(d.b,{activeClassName:"active",className:"nav-item nav-link",to:"/login"},"Login"),r.a.createElement(d.b,{activeClassName:"active",className:"nav-item nav-link",to:"/register"},"Register"))}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(d.b,{className:"navbar-brand",to:"/"},"Dating App"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup"},this.checkAuth()))}}]),t}(n.Component);var E=Object(i.b)(function(e){return e})(y),w=a(66),x=a(7),j=a.n(x),O=a(11),N=a(32),S=a.n(N),C=a(183),L=a.n(C),A=a(91);function I(e){return P.apply(this,arguments)}function P(){return(P=Object(O.a)(j.a.mark(function e(t){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,L.a.verify(t,A.secret);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(){return localStorage.removeItem("token"),{type:p,payload:null}}var B={serverURL:" https://dating-app-server-as.herokuapp.com/",awsBucketURL:"https://s3.ap-south-1.amazonaws.com/intern-images/"},D=(a(319),function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).state={users:[]},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"socketUserBlockListen",value:function(){var e=this;this.props.socket.on("block",function(t){var a=e.state.users.filter(function(e){return e.email!==t.user.email});e.setState({users:a})})}},{key:"likePicture",value:function(e){e.target.style.color="#58595b",this.props.socket.emit("like",this.props.user.email,e.target.getAttribute("data"))}},{key:"superLikePicture",value:function(e){e.target.style.color="#58595b",this.props.socket.emit("superlike",this.props.user.email,this.props.user.picture,e.target.getAttribute("data"))}},{key:"blockUser",value:function(e){e.target.style.color="#58595b",this.props.socket.emit("block",this.props.user,e.target.getAttribute("data"))}},{key:"checkAuth",value:function(){var e=Object(O.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.isAuthenticated||this.props.user){e.next=7;break}return e.next=3,I(localStorage.getItem("token"));case 3:(t=e.sent)?t&&this.props.loginExistingToken(t):this.props.logout(),e.next=8;break;case 7:this.props.isAuthenticated||this.props.history.push("/login");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createCards",value:function(e){var t=this;return e.map(function(e){return e.email!==t.props.user.email?r.a.createElement("div",{key:e._id,className:"card col-md-3 col-sm-6",style:{margin:"4%"}},r.a.createElement("img",{className:"card-img-top cardImage",src:e.picture,alt:e.id}),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{className:"card-text spreadIcons"},r.a.createElement("i",{className:"fas fa-thumbs-up icons",onClick:t.likePicture.bind(t),data:e._id}),r.a.createElement("i",Object(w.a)({className:"fas fa-heart icons",data:e._id,onClick:t.superLikePicture.bind(t)},"data",e._id)),r.a.createElement("i",{className:"fas fa-ban icons",onClick:t.blockUser.bind(t),data:e._id})))):null})}},{key:"componentDidMount",value:function(){var e=Object(O.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkAuth();case 2:if(!this.props.isAuthenticated){e.next=9;break}return this.socketUserBlockListen(),this.props.socket.emit("saveUserId",this.props.user.id),e.next=7,S.a.get("".concat(B.serverURL,"/users"));case 7:t=e.sent,this.setState({users:t.data.users});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"row"},this.createCards(this.state.users))}}]),t}(n.Component));var R=Object(i.b)(function(e){return e},{loginExistingToken:function(e){return{type:l,payload:e}},logout:U})(D),T=a(33),_=a(320),q=a(160),M=a(91).keys,H=new _.S3({signatureVersion:"v4",region:"ap-south-1",accessKeyId:M.accessKeyId,secretAccessKey:M.secretAccessKey}),K={getUploadConfig:function(){var e=Object(O.a)(j.a.mark(function e(){var t,a;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="images/".concat(q(),".jpg"),e.next=3,H.getSignedUrl("putObject",{Bucket:"intern-images",ContentType:"image/*",Key:t});case 3:return a=e.sent,e.abrupt("return",{key:t,url:a});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},F=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).state={email:"",password:"",picture:""},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.isAuthenticated&&this.props.history.push("/")}},{key:"postData",value:function(){var e=Object(O.a)(j.a.mark(function e(){var t,a,n;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getUploadConfig();case 2:return t=e.sent,e.next=5,S.a.put(t.url,this.state.picture,{headers:{"Content-Type":this.state.picture.type}});case 5:return a=B.awsBucketURL+t.key,n={picture:a,email:this.state.email,password:this.state.password},e.next=9,S.a.post("".concat(B.serverURL,"/register"),n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(){var e=Object(O.a)(j.a.mark(function e(t){var a;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),document.querySelector("#alert").innerHTML="<strong>Please wait while we register you.</strong>",e.next=4,this.postData();case 4:if(!(a=e.sent).data.auth||!a.data.token){e.next=11;break}return e.next=8,this.props.register(a.data.token);case 8:this.props.history.push("/"),e.next=12;break;case 11:a.data.auth||(document.querySelector("#alert").innerHTML="<strong>The user already exist in the database.</strong>");case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"row",style:{display:"flex",justifyContent:"center"}},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("h1",{style:{textAlign:"center"}},"Register"),r.a.createElement("p",{id:"alert"}),r.a.createElement("form",{onSubmit:this.onSubmit.bind(this)},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email address"),r.a.createElement("input",{type:"email",name:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Enter email",value:this.state.email,onChange:function(t){e.setState(Object(T.a)({},e.state,{email:t.target.value}))},required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputPassword1"},"Password"),r.a.createElement("input",{type:"password",name:"password",className:"form-control",id:"exampleInputPassword1",placeholder:"Password",pattern:".{6,}",title:"Six or more characters",value:this.state.password,onChange:function(t){e.setState(Object(T.a)({},e.state,{password:t.target.value}))},required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputFile1"},"Upload Picture"),r.a.createElement("input",{type:"file",name:"picture",className:"form-control",id:"exampleInputFile1",placeholder:"Picture",onChange:function(t){e.setState(Object(T.a)({},e.state,{picture:t.target.files[0]}))},accept:"image/*",required:!0})),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))}}]),t}(n.Component);var V=Object(i.b)(function(e){return e},{register:function(e){return function(){var t=Object(O.a)(j.a.mark(function t(a){var n;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.setItem("token",e),t.next=3,I(localStorage.getItem("token"));case 3:n=t.sent,a({type:l,payload:n});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(F),J=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).state={email:"",password:""},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.isAuthenticated&&this.props.history.push("/")}},{key:"postData",value:function(){var e=Object(O.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={email:this.state.email,password:this.state.password},e.next=3,S.a.post("".concat(B.serverURL,"/login"),t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(){var e=Object(O.a)(j.a.mark(function e(t){var a;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,this.postData();case 3:if(!(a=e.sent).data.auth||!a.data.token){e.next=10;break}return e.next=7,this.props.login(a.data.token);case 7:this.props.history.push("/"),e.next=11;break;case 10:a.data.auth||(document.querySelector("#alert").innerHTML="<strong>Email or Password incorrect.</strong>");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"row",style:{display:"flex",justifyContent:"center"}},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("h1",{style:{textAlign:"center"}},"Login"),r.a.createElement("p",{id:"alert"}),r.a.createElement("form",{onSubmit:this.onSubmit.bind(this)},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email address"),r.a.createElement("input",{type:"email",name:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Enter email",value:this.state.email,onChange:function(t){e.setState(Object(T.a)({},e.state,{email:t.target.value}))},required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputPassword1"},"Password"),r.a.createElement("input",{type:"password",name:"password",className:"form-control",id:"exampleInputPassword1",placeholder:"Password",value:this.state.password,onChange:function(t){e.setState(Object(T.a)({},e.state,{password:t.target.value}))},required:!0})),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))}}]),t}(n.Component);var W=Object(i.b)(function(e){return e},{login:function(e){return function(){var t=Object(O.a)(j.a.mark(function t(a){var n;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.setItem("token",e),t.next=3,I(localStorage.getItem("token"));case 3:n=t.sent,a({type:l,payload:n});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(J),Y=function(e){function t(){return Object(v.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.isAuthenticated&&this.props.history.push("/")}},{key:"render",value:function(){return this.props.logout(),r.a.createElement("div",null)}}]),t}(n.Component);var z=Object(i.b)(function(e){return e},{logout:U})(Y),$=a(184),G=a.n($),Q=(a(698),G()("".concat(B.serverURL)));var X=document.createElement("div");Q.on("like",function(e){X.innerHTML='\n            <div class="card w-50 likePicture">\n                <div class="card-body">\n                    <h5 class="card-title">Liked!!</h5>\n                    <p class="card-text">'.concat(e.message,'</p>\n                    <button class="btn btn-primary closeBox">Close</button>\n                </div>\n            </div>'),document.body.append(X),document.querySelector(".closeBox").addEventListener("click",function(){document.querySelector(".likePicture").remove()})}),Q.on("superlike",function(e){console.log(e.picture),X.innerHTML='\n            <div class="card likePicture" style="width: 18rem;">\n                <img class="card-img-top" src=\''.concat(e.picture,'\' alt="superliked profile">\n                <div class="card-body">\n                    <h5 class="card-title">SuperLiked!!</h5>\n                    <p class="card-text">').concat(e.message,'</p>\n                    <button class="btn btn-primary closeBox">close</button>\n                </div>\n        </div>'),document.body.append(X),document.querySelector(".closeBox").addEventListener("click",function(){document.querySelector(".likePicture").remove()})});var Z=function(){return r.a.createElement(d.a,null,r.a.createElement(E,null),r.a.createElement("div",{className:"container"},r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/",exact:!0,render:function(e){return r.a.createElement(R,Object.assign({},e,{socket:Q}))}}),r.a.createElement(h.b,{path:"/register",component:V}),r.a.createElement(h.b,{path:"/login",component:W}),r.a.createElement(h.b,{path:"/logout",component:z}),r.a.createElement(h.a,{to:"/",from:"*"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=Object(o.a)(u.a)(o.c);c.a.render(r.a.createElement(i.a,{store:ee(m)},r.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},86:function(e,t){},91:function(e,t){var a={accessKeyId:Object({NODE_ENV:"production",PUBLIC_URL:""}).ACCESSKEY,secretAccessKey:Object({NODE_ENV:"production",PUBLIC_URL:""}).SACCESSKEY},n=Object({NODE_ENV:"production",PUBLIC_URL:""}).JWTSECRET;e.exports={keys:a,secret:n}}},[[185,1,2]]]);
//# sourceMappingURL=main.c060a73c.chunk.js.map